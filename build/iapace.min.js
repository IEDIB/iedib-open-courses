window.IB = window.IB || {}; window.IB.sd = window.IB.sd || {}; window.IAPace=window.IAPace||{},function(e){var t=4,i=function(e){for(var t={},i=e.substring(1).split("&"),r=0;r<i.length;r++){var n=i[r].split("=");n[0]&&(t[n[0]]=n[1]||!0)}return t},r=function(e,t){this.coursename=e,this.defaultLevel=4>=t?t:4,this._tree={},this.load()};r.prototype={load:function(){var e=localStorage.getItem("iapace");try{this._tree=JSON.parse(e)}catch(t){console.error(t)}var i=!1;this._tree||(this._tree={},i=!0),this._tree[this.coursename]||(this._tree[this.coursename]={dl:this.defaultLevel,ch:{},ia:{}},i=!0),i&&this.save()},save:function(){this._tree&&localStorage.setItem("iapace",JSON.stringify(this._tree))},drop:function(e){for(var t=Object.keys(this._tree[this.coursename].ch),i=0,r=t.length;r>i;i++)t[i].startsWith(e)&&delete this._tree[this.coursename].ch[t[i]]},find:function(e){return this._tree[this.coursename].ch[e]},create:function(e){var t=e.split("."),i=t[0];this.find(i)||(this._tree[this.coursename].ch[i]={n:0,s:0,s2:0,h:[]});for(var r=1,n=t.length;n>r;r++)i=i+"."+t[r],this.find(i)||(this._tree[this.coursename].ch[i]={n:0,s:0,s2:0,h:[]});return this._tree[this.coursename].ch[e]},saveInitialEval:function(e,t){this._tree[this.coursename].ia[e]=t,this.save()},loadInitialEval:function(e){return this._tree[this.coursename].ia[e]},findCreate:function(e){var t=this.find(e);return t||(t=this.create(e)),t},addScore:function(e,i){var r=this.findCreate(e);for(r.n+=1,r.s+=i,r.s2+=i*i,r.h.push(i);r.h.length>t;)r.h.shift()},level:function(e){var i=this.findCreate(e),r=i.n;if(r>0){var n=i.s/(1*r),s=Math.sqrt(Math.abs(i.s2/r-n*n));if(0==n)return 1;var a=s/n;if(i.h.length>=t){for(var h=0,o=0,c=i.h.length,u=0;c>u;u++){var f=i.h[u];h+=f,o+=f*f}if(h/=1*c,o=Math.sqrt(o/(1*c)-h*h),h>0&&(cv2=o/h,cv2<.75)){var l=.1*n+.9*h;n=l>n?l:n}}var v=Math.round(.4*n);return v>1&&a>.75&&(v-=1),v>0?v:1}return i.dl},inference:function(e){var t=this.find(e),i=e.split("."),r=i.slice(0,i.length-1).join(".");if(t){var n=this.level(e);return n?n:r?this.inference(r):this._tree[this.coursename].dl}return r?this.inference(r):this._tree[this.coursename].dl},toString:function(){return JSON.stringify(this._tree,null,2)}},e.load=function(e,t){return new r(e,t)},window.IB=window.IB||{};var n,s="",a=document.querySelector(".homelink > a");if(a){courseName=a.innerText;var h="?"+(a.href.split("?")[1]||"");n=i(h).id}s=s||n||"cmat0",window.IB.iapace=new r(s,2)}(window.IAPace);