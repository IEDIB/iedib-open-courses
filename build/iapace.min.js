window.IB = window.IB || {}; window.IB.sd = window.IB.sd || {}; window.IAPace=window.IAPace||{},function(e){var t=function(e){for(var t={},i=e.substring(1).split("&"),r=0;r<i.length;r++){var n=i[r].split("=");n[0]&&(t[n[0]]=n[1]||!0)}return t},i=function(e,t){this.coursename=e,this.defaultLevel=4>=t?t:4,this._tree={},this.load()};i.prototype={load:function(){var e=localStorage.getItem("iapace");try{this._tree=JSON.parse(e)}catch(t){console.error(t)}var i=!1;this._tree||(this._tree={},i=!0),this._tree[this.coursename]||(this._tree[this.coursename]={dl:this.defaultLevel,ch:{},ia:{}},i=!0),i&&this.save()},save:function(){this._tree&&localStorage.setItem("iapace",JSON.stringify(this._tree))},drop:function(e){for(var t=Object.keys(this._tree[this.coursename].ch),i=0,r=t.length;r>i;i++)t[i].startsWith(e)&&delete this._tree[this.coursename].ch[t[i]]},find:function(e){return this._tree[this.coursename].ch[e]},create:function(e){var t=e.split("."),i=t[0];this.find(i)||(this._tree[this.coursename].ch[i]={n:0,s:0,s2:0,h:[]});for(var r=1,n=t.length;n>r;r++)i=i+"."+t[r],this.find(i)||(this._tree[this.coursename].ch[i]={n:0,s:0,s2:0,h:[]});return this._tree[this.coursename].ch[e]},saveInitialEval:function(e,t){this._tree[this.coursename].ia[e]=t,this.save()},loadInitialEval:function(e){return this._tree[this.coursename].ia[e]},findCreate:function(e){var t=this.find(e);return t||(t=this.create(e)),t},addScore:function(e,t){var i=this.findCreate(e);for(i.n+=1,i.s+=t,i.s2+=t*t,i.h.push(t);i.h.length>3;)i.h.pop()},level:function(e){var t=this.findCreate(e),i=t.n;if(i>0){var r=t.s/(1*i),n=Math.sqrt(Math.abs(t.s2/i-r*r));if(0==r)return 0;var s=n/r,a=Math.floor(.4*r);return a>0&&s>.75&&(a-=1),a}return t.dl},inference:function(e){var t=this.find(e),i=e.split("."),r=i.slice(0,i.length-1).join(".");if(t){var n=this.level(e);return n?n:r?this.inference(r):this._tree[this.coursename].dl}return r?this.inference(r):this._tree[this.coursename].dl},toString:function(){return JSON.stringify(this._tree,null,2)}},e.load=function(e,t){return new i(e,t)},window.IB=window.IB||{};var r,n="",s=document.querySelector(".homelink > a");if(s){courseName=s.innerText;var a="?"+(s.href.split("?")[1]||"");r=t(a).id}n=n||r||"cmat0",window.IB.iapace=new i(n,2)}(window.IAPace);