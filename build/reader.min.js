window.IB = window.IB || {}; window.IB.sd = window.IB.sd || {}; !function(e){var n=window.speechSynthesis,o=null!=n&&null!=window.SpeechSynthesisUtterance,r=function(e,n){e=(e||"").toLowerCase();for(var o=0,r=null,t=(n||[]).length;t>o&&null==r;)console.error("Compare",n[o],e),n[o].lang.toLowerCase()==e&&(r=n[o]),o++;return r},t=[],s=function(){window.addEventListener("unload",function(e){window.speechSynthesis.cancel()}),t=window.speechSynthesis.getVoices()},i=["ca-ES","es-ES"];e.reader=function(n,s){if(s=s||0,o){if(!t.length)return void(3>s&&setTimeout(function(){console.log(t,"trying latter...",s),e.reader(n,s+1)},800));var c=null,l=null;console.error(t);for(var a=0,h=i.length;h>a&&(l=i[a],console.error(l),c=r(i[a],t),null==c);a++);c&&n[l]||console.error("No voice/text found"),window.speechSynthesis.cancel();var u=n[l],w=new SpeechSynthesisUtterance(u);w.voice=c,window.speechSynthesis.speak(w)}},o?(n.getVoices()||[]).length?s():n.addEventListener("voiceschanged",function(){s()}):console.error("Sorry: SpeechSynthesis not supported in browser.")}(window.IB);